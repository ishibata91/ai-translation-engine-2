# Proposal: frontend-job-manager

## Context & Motivation
Wailsを用いたフロントエンドからGo側の処理（辞書構築などの重い処理）を非同期実行し、その状態や進捗を監視（ダッシュボード等で表示）できるようにしたい。
単なるインメモリ管理ではアプリ終了時に状態が失われるため、予期せぬ終了時でも再開可能（レジューム）にする仕組みが必要である。
また、翻訳ステップごとのステータス管理や、別画面での作業中であっても「辞書」や「マスターペルソナ」のNPCリストがリアルタイムで部分追加されていくようなユーザビリティを実現したい。
このため、UIと密接に連携する「フロントエンド特化のタスク管理層」をGo側に設け、タスクの永続化、フェーズに応じた画面遷移のサポート、および部分完了通知の仕組みを構築する。

## Affected Capabilities
- `progress`: 既存の進捗管理インフラを、フロントエンドタスクマネージャー経由で通知できるように連携設計を見直す。
- `pipeline`: ステップごとのステータス管理や再開ロジックのため、Pipelineとの責務分界点を整理する。
- `queue`: インフラ層の非同期タスク管理と、フロントエンドタスク（UI表示用）の連携。

## New Capabilities
- `frontend-task`: フロントエンドタスクの永続化、ID採番、ステータス（実行中、完了、エラー）、フェーズ（複数ステップ進行）、全体の進捗管理、キャンセル要求を扱うタスクマネージャー。
- `realtime-update`: タスク実行中の部分完了（1ファイル完了、NPC10件抽出など）を捉え、フロントエンドのリスト画面へリアルタイムに追加・反映させるイベント機構。
- `api-bindings`: WailsフロントからGo側のメソッドを呼び出すバインディング（`GetActiveTasks`, `CancelTask`, `ResumeTask` など）。

## Impact
- `pkg/wailsbindings/` (新規追加や拡張)
- `pkg/taskmanager/` (タスク状態の永続化・管理)
- `specs/database_erd.md` (タスク永続化用のテーブル追加)
- Frontend: `Dashboard.tsx`（タスク状態の購読、フェーズに応じた画面遷移）
- Frontend: `DictionaryBuilder.tsx` や `MasterPersona`（タスク開始API呼び出し、部分完了イベントの購読によるリアルタイムリスト反映）
